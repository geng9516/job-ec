<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="con.chin.mapper.ItemMapper">

    <!--    新产品登录-->
    <insert id="saveItem">

        insert into t_item (sitename,
                            shopname,
                            itemcode,
                            olditemcode,
                            itempath,
                            itemcategorycode,
                            itemname,
                            price,
                            option1,
                            value1,
                            option2,
                            value2,
                            option3,
                            value3,
                            option4,
                            value4,
                            option5,
                            value5,
                            url5,
                            headline,
                            caption,
                            explanation,
                            image,
                            flog,
                            created,
                            updatetime,
                            enddate)
        values (#{siteName},
                #{shopName},
                #{itemCode},
                #{oldItemCode},
                #{itemPath},
                #{itemCategoryCode},
                #{itemName},
                #{price},
                #{option1},
                #{value1},
                #{option2},
                #{value2},
                #{option3},
                #{value3},
                #{option4},
                #{value4},
                #{option5},
                #{value5},
                #{url5},
                #{headline},
                #{caption},
                #{explanation},
                #{image},
                #{flog},
                #{created},
                #{updatetime},
                #{endDate})

    </insert>

    <!--    产品更新-->
    <update id="updateItem">

        update t_item
        set shopname=#{shopName},
            itemname=#{itemName},
            price=#{price},
            option1=#{option1},
            option1=#{option1},
            value1=#{value1},
            option2=#{option2},
            value2=#{value2},
            option3=#{option3},
            value3=#{value3},
            option4=#{option4},
            value4=#{value4},
            option5=#{option5},
            value5=#{value5},
            headline=#{headline},
            url5=#{url5},
            explanation=#{explanation},
            updatetime=#{updatetime},
            flog=#{flog}
        where oldItemCode = #{oldItemCode}

    </update>

    <!--    已编辑并且没有失效的产品-->
    <select id="findAllItem" resultType="con.chin.pojo.Item">

        select *
        from t_item
        where flog = 1
          and enddate = '2099-12-31 23:59:59'

    </select>


    <!--    旧产品code检索-->
    <select id="findItem" resultType="con.chin.pojo.Item">

        select *
        from t_item
        where olditemcode = #{oldItemCode}

    </select>

    <!--    产品id,产品path,产品名,店铺名模糊查询-->
    <select id="findItemBySearchConditions" resultType="con.chin.pojo.Item">

        select *
        from t_item
        <where>


            <if test="searchConditions != null and searchConditions != ''">
                and ( itemcode like concat('%',#{searchConditions},'%')
            </if>
            <if test="searchConditions != null and searchConditions != ''">
                or itempath like '%' #{searchConditions} '%'
            </if>
            <if test="searchConditions != null and searchConditions != ''">
                or itemname like concat('%',#{searchConditions},'%')
            </if>
            <if test="searchConditions != null and searchConditions != ''">
                or shopname like concat('%',#{searchConditions},'%')
            </if>
            <if test="searchConditions != null and searchConditions != ''">
                or olditemcode like concat('%',#{searchConditions},'%') )
            </if>
            <if test="shopName != null and shopName != ''">
                and shopname = #{shopName}
            </if>
            <if test="flog != null and flog != ''">
                and flog = #{flog}
            </if>

        </where>

        order by updatetime desc

    </select>

    <!--    SiteShop查询-->
    <select id="findItemBySiteShop" resultType="con.chin.pojo.Item">

        select *
        from t_item
        <where>

            <if test="searchConditions != null and searchConditions != ''">
                and shopname like concat('%',#{searchConditions},'%')
            </if>

        </where>

        order by updatetime desc

    </select>

    <!--    获取产品code-->
    <select id="findItemCodeByPath" resultType="string">

        select itemcode
        from t_item
        where itempath = #{path}

    </select>

    <delete id="deleteItem">
        delete
        from t_item
        where itemcode = #{itemCode}
    </delete>

    <update id="setItemSalePrice">
        update t_item
        set purchaseprice=#{purchasePrice},
            delivery=#{delivery},
            saleprice=#{salePrice},
            url1=#{url1},
            url2=#{url2},
            url3=#{url3}
        where itemcode = #{itemCode}
    </update>

<!--    新itemcode查询-->
    <select id="findItemByItemCode" resultType="con.chin.pojo.Item">
        select * from t_item
        where itemcode = #{itemCode}
    </select>


    <!--    ###################数据错误时修改用########################-->

    <select id="findAll" resultType="con.chin.pojo.Item">

        select *
        from t_item

    </select>

    <update id="setdate">
        update t_item
        set image = #{image}
        where itemcode = #{itemCode}
    </update>


</mapper>































